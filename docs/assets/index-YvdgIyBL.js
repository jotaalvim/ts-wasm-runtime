(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&s(m)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const lt=new WeakMap,Qt=e=>(...t)=>{const n=e(...t);return lt.set(n,!0),n},_e=e=>typeof e=="function"&&lt.has(e);/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Ue=typeof window<"u"&&window.customElements!=null&&window.customElements.polyfillWrapFlushCallback!==void 0,it=(e,t,n=null)=>{for(;t!==n;){const s=t.nextSibling;e.removeChild(t),t=s}};/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Q={},De={};/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const oe=`{{lit-${String(Math.random()).slice(2)}}}`,ut=`<!--${oe}-->`,We=new RegExp(`${oe}|${ut}`),he="$lit$";class Xt{constructor(t,n){this.parts=[],this.element=n;const s=[],r=[],i=document.createTreeWalker(n.content,133,null,!1);let m=0,_=-1,y=0;const{strings:k,values:{length:A}}=t;for(;y<A;){const w=i.nextNode();if(w===null){i.currentNode=r.pop();continue}if(_++,w.nodeType===1){if(w.hasAttributes()){const P=w.attributes,{length:ue}=P;let se=0;for(let S=0;S<ue;S++)Ge(P[S].name,he)&&se++;for(;se-- >0;){const S=k[y],z=Be.exec(S)[2],W=z.toLowerCase()+he,G=w.getAttribute(W);w.removeAttribute(W);const R=G.split(We);this.parts.push({type:"attribute",index:_,name:z,strings:R}),y+=R.length-1}}w.tagName==="TEMPLATE"&&(r.push(w),i.currentNode=w.content)}else if(w.nodeType===3){const P=w.data;if(P.indexOf(oe)>=0){const ue=w.parentNode,se=P.split(We),S=se.length-1;for(let z=0;z<S;z++){let W,G=se[z];if(G==="")W=re();else{const R=Be.exec(G);R!==null&&Ge(R[2],he)&&(G=G.slice(0,R.index)+R[1]+R[2].slice(0,-he.length)+R[3]),W=document.createTextNode(G)}ue.insertBefore(W,w),this.parts.push({type:"node",index:++_})}se[S]===""?(ue.insertBefore(re(),w),s.push(w)):w.data=se[S],y+=S}}else if(w.nodeType===8)if(w.data===oe){const P=w.parentNode;(w.previousSibling===null||_===m)&&(_++,P.insertBefore(re(),w)),m=_,this.parts.push({type:"node",index:_}),w.nextSibling===null?w.data="":(s.push(w),_--),y++}else{let P=-1;for(;(P=w.data.indexOf(oe,P+1))!==-1;)this.parts.push({type:"node",index:-1}),y++}}for(const w of s)w.parentNode.removeChild(w)}}const Ge=(e,t)=>{const n=e.length-t.length;return n>=0&&e.slice(n)===t},Yt=e=>e.index!==-1,re=()=>document.createComment(""),Be=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */class Je{constructor(t,n,s){this.__parts=[],this.template=t,this.processor=n,this.options=s}update(t){let n=0;for(const s of this.__parts)s!==void 0&&s.setValue(t[n]),n++;for(const s of this.__parts)s!==void 0&&s.commit()}_clone(){const t=Ue?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),n=[],s=this.template.parts,r=document.createTreeWalker(t,133,null,!1);let i=0,m=0,_,y=r.nextNode();for(;i<s.length;){if(_=s[i],!Yt(_)){this.__parts.push(void 0),i++;continue}for(;m<_.index;)m++,y.nodeName==="TEMPLATE"&&(n.push(y),r.currentNode=y.content),(y=r.nextNode())===null&&(r.currentNode=n.pop(),y=r.nextNode());if(_.type==="node"){const k=this.processor.handleTextExpression(this.options);k.insertAfterNode(y.previousSibling),this.__parts.push(k)}else this.__parts.push(...this.processor.handleAttributeExpressions(y,_.name,_.strings,this.options));i++}return Ue&&(document.adoptNode(t),customElements.upgrade(t)),t}}/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Ke=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),en=` ${oe} `;class ct{constructor(t,n,s,r){this.strings=t,this.values=n,this.type=s,this.processor=r}getHTML(){const t=this.strings.length-1;let n="",s=!1;for(let r=0;r<t;r++){const i=this.strings[r],m=i.lastIndexOf("<!--");s=(m>-1||s)&&i.indexOf("-->",m+1)===-1;const _=Be.exec(i);_===null?n+=i+(s?en:ut):n+=i.substr(0,_.index)+_[1]+_[2]+he+_[3]+oe}return n+=this.strings[t],n}getTemplateElement(){const t=document.createElement("template");let n=this.getHTML();return Ke!==void 0&&(n=Ke.createHTML(n)),t.innerHTML=n,t}}/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Ne=e=>e===null||!(typeof e=="object"||typeof e=="function"),Ve=e=>Array.isArray(e)||!!(e&&e[Symbol.iterator]);class pt{constructor(t,n,s){this.dirty=!0,this.element=t,this.name=n,this.strings=s,this.parts=[];for(let r=0;r<s.length-1;r++)this.parts[r]=this._createPart()}_createPart(){return new ft(this)}_getValue(){const t=this.strings,n=t.length-1,s=this.parts;if(n===1&&t[0]===""&&t[1]===""){const i=s[0].value;if(typeof i=="symbol")return String(i);if(typeof i=="string"||!Ve(i))return i}let r="";for(let i=0;i<n;i++){r+=t[i];const m=s[i];if(m!==void 0){const _=m.value;if(Ne(_)||!Ve(_))r+=typeof _=="string"?_:String(_);else for(const y of _)r+=typeof y=="string"?y:String(y)}}return r+=t[n],r}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class ft{constructor(t){this.value=void 0,this.committer=t}setValue(t){t!==Q&&(!Ne(t)||t!==this.value)&&(this.value=t,_e(t)||(this.committer.dirty=!0))}commit(){for(;_e(this.value);){const t=this.value;this.value=Q,t(this)}this.value!==Q&&this.committer.commit()}}class be{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(re()),this.endNode=t.appendChild(re())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=re()),t.__insert(this.endNode=re())}insertAfterPart(t){t.__insert(this.startNode=re()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(this.startNode.parentNode===null)return;for(;_e(this.__pendingValue);){const n=this.__pendingValue;this.__pendingValue=Q,n(this)}const t=this.__pendingValue;t!==Q&&(Ne(t)?t!==this.value&&this.__commitText(t):t instanceof ct?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):Ve(t)?this.__commitIterable(t):t===De?(this.value=De,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const n=this.startNode.nextSibling;t=t??"";const s=typeof t=="string"?t:String(t);n===this.endNode.previousSibling&&n.nodeType===3?n.data=s:this.__commitNode(document.createTextNode(s)),this.value=t}__commitTemplateResult(t){const n=this.options.templateFactory(t);if(this.value instanceof Je&&this.value.template===n)this.value.update(t.values);else{const s=new Je(n,t.processor,this.options),r=s._clone();s.update(t.values),this.__commitNode(r),this.value=s}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const n=this.value;let s=0,r;for(const i of t)r=n[s],r===void 0&&(r=new be(this.options),n.push(r),s===0?r.appendIntoPart(this):r.insertAfterPart(n[s-1])),r.setValue(i),r.commit(),s++;s<n.length&&(n.length=s,this.clear(r&&r.endNode))}clear(t=this.startNode){it(this.startNode.parentNode,t.nextSibling,this.endNode)}}class tn{constructor(t,n,s){if(this.value=void 0,this.__pendingValue=void 0,s.length!==2||s[0]!==""||s[1]!=="")throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=n,this.strings=s}setValue(t){this.__pendingValue=t}commit(){for(;_e(this.__pendingValue);){const n=this.__pendingValue;this.__pendingValue=Q,n(this)}if(this.__pendingValue===Q)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=Q}}class nn extends pt{constructor(t,n,s){super(t,n,s),this.single=s.length===2&&s[0]===""&&s[1]===""}_createPart(){return new sn(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class sn extends ft{}let dt=!1;(()=>{try{const e={get capture(){return dt=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{}})();class rn{constructor(t,n,s){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=n,this.eventContext=s,this.__boundHandleEvent=r=>this.handleEvent(r)}setValue(t){this.__pendingValue=t}commit(){for(;_e(this.__pendingValue);){const i=this.__pendingValue;this.__pendingValue=Q,i(this)}if(this.__pendingValue===Q)return;const t=this.__pendingValue,n=this.value,s=t==null||n!=null&&(t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive),r=t!=null&&(n==null||s);s&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=on(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=Q}handleEvent(t){typeof this.value=="function"?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const on=e=>e&&(dt?{capture:e.capture,passive:e.passive,once:e.once}:e.capture);/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */class an{handleAttributeExpressions(t,n,s,r){const i=n[0];return i==="."?new nn(t,n.slice(1),s).parts:i==="@"?[new rn(t,n.slice(1),r.eventContext)]:i==="?"?[new tn(t,n.slice(1),s)]:new pt(t,n,s).parts}handleTextExpression(t){return new be(t)}}const ln=new an;/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */function un(e){let t=Qe.get(e.type);t===void 0&&(t={stringsArray:new WeakMap,keyString:new Map},Qe.set(e.type,t));let n=t.stringsArray.get(e.strings);if(n!==void 0)return n;const s=e.strings.join(oe);return n=t.keyString.get(s),n===void 0&&(n=new Xt(e,e.getTemplateElement()),t.keyString.set(s,n)),t.stringsArray.set(e.strings,n),n}const Qe=new Map;/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Xe=new WeakMap,cn=(e,t,n)=>{let s=Xe.get(t);s===void 0&&(it(t,t.firstChild),Xe.set(t,s=new be(Object.assign({templateFactory:un},n))),s.appendInto(t)),s.setValue(e),s.commit()};/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */typeof window<"u"&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.3.0");const le=(e,...t)=>new ct(e,t,"html",ln);/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const Ye=new WeakMap,pn=Qt(e=>t=>{if(!(t instanceof be))throw new Error("unsafeHTML can only be used in text bindings");const n=Ye.get(t);if(n!==void 0&&Ne(e)&&e===n.value&&t.value===n.fragment)return;const s=document.createElement("template");s.innerHTML=e;const r=document.importNode(s.content,!0);t.setValue(r),Ye.set(t,{value:e,fragment:r})});function p(...e){return(t,n)=>{const s=[];for(let r of e){const i=r(t,n);if(i[0])s.push(i[1]),n=i[2];else return[!1,null,n,`seq@${n}: ${i[3]}`]}return[!0,s,n]}}function E(...e){return(t,n)=>{const s=[];for(let r of e){const i=r(t,n);if(i[0])return i;s.push(r[2])}return[!1,null,n,`or@${n}: expected ${s.join(" or ")}`]}}const ie=e=>{let t;return(n,s)=>(t===void 0&&(t=e()),t(n,s))},f=e=>(t,n)=>{const s=e(t,n);return s[0]?s:[!0,null,n,`opt@${n}: ${s[3]}`]},g=e=>(t,n)=>{const s=[];for(;;){const r=e(t,n);if(r[0])s.push(r[1]),n=r[2];else break}return s.length===0?[!1,null,n,`many@${n}: cannot parse`]:[!0,s,n]},c=(e,t)=>(n,s)=>{const r=e(n,s);return r[0]?[r[0],t(r[1]),r[2]]:[!1,null,r[2],`map@${s}: ${r[3]}`]},fn=(e,t)=>[!0,e[t],t+1],Ee=(e,t)=>(n,s)=>{const r=e(n,s);return r[0]?t(r[1])(n,r[2]):[!1,null,s,r[3]]},dn=(e,t)=>(n,s)=>{const r=[];for(let i=0;i<t;i++){const m=e(n,s);if(m[0])r.push(m[1]),s=m[2];else return[!1,null,s,`vec@${s}: ${m[3]}`]}return[!0,r,s]},hn=e=>(t,n)=>[!0,e,n],et=e=>(t,n)=>t.substr(n,e.length)===e?[!0,e,n+e.length]:[!1,null,n,`token@${n}: ${t.substr(n,e.length)} is not ${e}`],te=e=>(t,n)=>{e.lastIndex=0;const s=e.exec(t.slice(n));return s?[!0,s[0],n+s[0].length]:[!1,null,n,`regexp@${n}: ${t.slice(n)} does not match ${e.source}`]},mn=te(/^([^)^(^ ^\n]+)/),_n=te(/^;;.*\n/),me=g(E(te(/^\s+/),_n)),ht=ie(()=>c(p(f(me),c(p(et("("),f(me),tt,f(g(c(p(me,tt),e=>e[1]))),f(me),et(")")),e=>e[3]!==null?[e[2],...e[3]]:[e[2]])),e=>e[1])),tt=E(mn,ht),mt=ht;g(c(p(mt,f(me)),e=>e[0]));const j=e=>[].concat(...e),Se=(e,t)=>Array.from({length:t-e},(n,s)=>s+e),_t=e=>typeof e=="string",x=e=>(t,n)=>t[n]===e?[!0,e,n+1]:[!1,null,n,`keyword@${n}: ${t[n]} is not ${e}`],ce=e=>(t,n)=>{const s=t[n];if(!_t(s))return[!1,null,n,`regexp@${n}: ${t[n]} is not string`];e.lastIndex=0;const r=e.exec(s);return r?[!0,r[1],n+1]:[!1,null,n,`regexp@${n}: ${t[n]} does not match ${e.source}`]},v=e=>(t,n)=>{const s=t[n];if(!Array.isArray(s))return[!1,null,n,`array@${n}: ${t} is not array`];const r=e(s,0);return r[0]?[!0,r[1],n+1]:[!1,null,n,r[3]]},gt=e=>(t,n)=>{const s=t[n];if(!_t(s))return[!1,null,n,`match@${n}: ${t[n]} is not string`];const r=e(s,0);return r[0]&&r[2]===s.length?[!0,r[1],n+1]:[!1,null,n,`match@${n}: ${t[n]} does not match parser`]};var L;(function(e){e.i32="i32",e.i64="i64",e.f32="f32",e.f64="f64"})(L||(L={}));const xt=E(c(te(/^(-?0x[0-9a-fA-F][0-9a-fA-F_]*)$/),parseInt),c(te(/^([-\+]?[0-9]+\.?[0-9]*?[Ee]?[-\+]?[0-9]*)$/),parseFloat),c(te(/^([-\+]?nan)$/),()=>NaN),c(te(/^([-\+]?nan:0x[0-9a-fA-F]+)$/),()=>NaN),c(te(/^(\+?inf)$/),()=>1/0),c(te(/^(-inf)$/),()=>-1/0)),Le=E(ce(/^(-?[0-9]+)$/),ce(/^(-?0x[0-9a-fA-F][0-9a-fA-F_]*)$/)),gn=c(Le,e=>({i32:parseInt(e)})),xn=c(Le,e=>({i64:BigInt(e)})),bn=c(gt(xt),e=>({f32:e})),vn=c(gt(xt),e=>({f64:e})),N=ce(/^(\$[a-zA-Z_][a-zA-Z0-9_.+-\\*/\\^~=<>!?@#$%&|:'`]*)$/),wn=ce(/^([a-zA-Z]+)$/),fe=ce(/^\"(.+)\"/),C=c(Le,parseInt);E(C,N);const ge=E(x(L.i32),x(L.i64),x(L.f32),x(L.f64)),ve=c(p(x("result"),ge),e=>e[1]),yn=ie(()=>pe),bt=(e,t)=>c(p(x(e),f(N),f(v(ve)),f(g(yn))),n=>({opType:t,identifier:n[1],results:n[2]?[n[2]]:[],body:j(n[3]||[])})),Tn=(e,t)=>c(p(bt(e,t),x("end")),n=>n[0]),$n=(e,t)=>v(bt(e,t)),vt=(e,t)=>E(Tn(e,t),$n(e,t)),In=vt("block","text.block"),Nn=vt("loop","text.loop"),En=E(In,Nn),ae=ie(()=>pe),Sn=c(p(x("if"),f(N),f(v(ve)),f(g(ae)),x("else"),f(g(ae)),x("end")),e=>[{opType:"text.if",identifier:e[1],results:e[2]?[e[2]]:[],then:j(e[3]||[]),else:j(e[5]||[])}]),qn=c(v(p(x("if"),f(N),f(v(ve)),f(ae),v(p(x("then"),f(g(ae)))),v(p(x("else"),f(g(ae)))))),e=>[...e[3]||[],{opType:"text.if",identifier:e[1],results:e[2]?[e[2]]:[],then:j(e[4][1]||[]),else:j(e[5][1]||[])}]),On=c(p(x("if"),f(N),f(g(ae)),x("end")),e=>[{opType:"text.if",results:[],identifier:e[1],then:j(e[2]||[]),else:[]}]),Mn=c(v(p(x("if"),f(N),f(ae),v(p(x("then"),f(g(ae)))))),e=>[...e[2]||[],{opType:"text.if",results:[],identifier:e[1],then:j(e[3][1]||[]),else:[]}]),kn=E(Sn,qn,On,Mn),o=e=>c(x(e),t=>({opType:e})),F=(e,t,n)=>c(p(x(t),n),s=>({opType:e,parameter:s[1]})),B=(e,t)=>F(e,e,t),An=(e,t,n)=>c(p(x(t),g(n)),s=>({opType:e,parameters:s[1]})),Cn=(e,t)=>c(p(x(e),g(t)),n=>({opType:e,parameters:n[1]})),nt=e=>c(ce(new RegExp(`^${e}=([0-9]+)`)),t=>parseInt(t,10)),I=e=>c(p(x(e),f(nt("offset")),f(nt("align"))),t=>({opType:t[0],offset:t[1],align:t[2]})),wt=E(B("i32.const",gn),B("i64.const",xn),B("f32.const",bn),B("f64.const",vn)),yt=E(B("get_global",C),F("text.get_global","get_global",N)),Tt=E(B("global.get",C),F("text.global.get","global.get",N)),$t=E(wt,yt,Tt),It=E(wt,o("nop"),o("unreachable"),B("br",C),F("text.br","br",N),B("br_if",C),F("text.br_if","br_if",N),Cn("br_table",C),An("text.br_table","br_table",N),B("call",C),F("text.call","call",N),o("call_indirect"),o("drop"),o("select"),o("return"),B("local.get",C),F("text.local.get","local.get",N),B("local.set",C),F("text.local.set","local.set",N),B("get_local",C),F("text.get_local","get_local",N),B("set_local",C),F("text.set_local","set_local",N),B("local.tee",C),F("text.local.tee","local.tee",N),B("tee_local",C),F("text.tee_local","tee_local",N),Tt,yt,B("global.set",C),F("text.global.set","global.set",N),B("set_global",C),F("text.set_global","set_global",N),o("i32.add"),o("i64.add"),o("f32.add"),o("f64.add"),o("i32.sub"),o("i64.sub"),o("f32.sub"),o("f64.sub"),o("i32.mul"),o("i64.mul"),o("f32.mul"),o("f64.mul"),o("f32.div"),o("f64.div"),o("i32.div_s"),o("i64.div_s"),o("i32.div_u"),o("i64.div_u"),o("i32.rem_s"),o("i64.rem_s"),o("i32.rem_u"),o("i64.rem_u"),o("i32.and"),o("i64.and"),o("i32.or"),o("i64.or"),o("i32.xor"),o("i64.xor"),o("i32.shl"),o("i64.shl"),o("i32.shr_s"),o("i64.shr_s"),o("i32.shr_u"),o("i64.shr_u"),o("i32.rotl"),o("i64.rotl"),o("i32.rotr"),o("i64.rotr"),o("i32.eq"),o("i64.eq"),o("f32.eq"),o("f64.eq"),o("i32.ne"),o("i64.ne"),o("f32.ne"),o("f64.ne"),o("i32.lt_s"),o("i64.lt_s"),o("i32.lt_u"),o("i64.lt_u"),o("f32.lt"),o("f64.lt"),o("i32.le_s"),o("i64.le_s"),o("i32.le_u"),o("i64.le_u"),o("f32.le"),o("f64.le"),o("i32.gt_s"),o("i64.gt_s"),o("i32.gt_u"),o("i64.gt_u"),o("f32.gt"),o("f64.gt"),o("i32.ge_s"),o("i64.ge_s"),o("i32.ge_u"),o("i64.ge_u"),o("f32.ge"),o("f64.ge"),o("i32.clz"),o("i64.clz"),o("i32.ctz"),o("i64.ctz"),o("i32.popcnt"),o("i64.popcnt"),o("i32.eqz"),o("i64.eqz"),o("f32.abs"),o("f64.abs"),o("f32.neg"),o("f64.neg"),o("f32.copysign"),o("f64.copysign"),o("f32.ceil"),o("f64.ceil"),o("f32.floor"),o("f64.floor"),o("f32.trunc"),o("f64.trunc"),o("f32.nearest"),o("f64.nearest"),o("f32.sqrt"),o("f64.sqrt"),o("f32.min"),o("f64.min"),o("f32.max"),o("f64.max"),o("i32.wrap/i64"),o("i32.trunc_f32_s"),o("i32.trunc_f64_s"),o("i32.trunc_f32_u"),o("i32.trunc_f64_u"),o("i64.extend_i32_s"),o("i64.extend_i32_u"),o("i64.trunc_f32_s"),o("i64.trunc_f64_s"),o("i64.trunc_f32_u"),o("i64.trunc_f64_u"),o("i32.reinterpret/f32"),o("i64.reinterpret/f64"),o("f32.reinterpret/i32"),o("f64.reinterpret/i64"),o("f32.demote/f64"),o("f32.convert_i32_s"),o("f32.convert_i64_s"),o("f32.convert_i32_u"),o("f32.convert_i64_u"),o("f64.promote/f32"),o("f64.convert_i32_s"),o("f64.convert_i64_s"),o("f64.convert_i32_u"),o("f64.convert_i64_u"),I("i32.load"),I("i64.load"),I("f32.load"),I("f64.load"),I("i32.load8_u"),I("i32.load8_s"),I("i32.load16_s"),I("i32.load16_u"),I("i64.load8_s"),I("i64.load8_u"),I("i64.load16_s"),I("i64.load16_u"),I("i64.load32_s"),I("i64.load32_u"),I("f32.load8_s"),I("f32.load8_u"),I("f32.load16_s"),I("f32.load16_u"),I("f64.load8_s"),I("f64.load8_u"),I("f64.load16_s"),I("f64.load16_u"),I("i32.store"),I("i64.store"),I("f32.store"),I("f64.store"),I("i32.store8"),I("i32.store16"),I("i64.store8"),I("i64.store16"),I("i64.store32")),Bn=c(v(p(It,f(c(g(ie(()=>pe)),e=>j(e))))),e=>[...e[1]?e[1]:[],e[0]]),pe=E(ie(()=>c(En,e=>[e])),ie(()=>kn),c(It,e=>[e]),Bn),Nt=c(p(x("param"),f(N),g(ge)),e=>e[2].map(t=>({identifier:e[1],type:t}))),Vn=c(p(x("local"),f(N),g(ge)),e=>e[2].map(t=>({identifier:e[1],type:t}))),Pn=c(g(pe),e=>j(e)),zn=c(p(x("func"),f(N),f(c(v(p(x("export"),fe)),e=>e[1])),f(g(v(Nt))),f(v(ve)),f(g(v(Vn))),f(Pn)),e=>({nodeType:"func",identifier:e[1],export:e[2],parameters:j(e[3]||[]),results:e[4]?[e[4]]:[],locals:j(e[5]||[]),body:e[6]||[]})),Fn=c(p(x("export"),fe,E(v(p(x("func"),N)),v(p(x("memory"),N)))),e=>({nodeType:"export",exportType:e[2][0],identifier:e[2][1]})),Ln=c(p(x("global"),f(N),f(c(v(p(x("export"),fe)),e=>e[1])),E(c(ge,e=>({mutable:!1,type:e})),c(v(p(x("mut"),ge)),e=>({mutable:!0,type:e[1]}))),v($t)),e=>({nodeType:"global",identifier:e[1],export:e[2],type:e[3].type,mutable:e[3].mutable,init:e[4]})),jn=c(p(x("memory"),f(N),f(c(v(p(x("export"),fe)),e=>e[1])),C),e=>({nodeType:"memory",identifier:e[1],export:e[2]})),Hn=c(p(x("table"),f(N),f(c(v(p(x("export"),fe)),e=>e[1])),C,C,wn),e=>({nodeType:"table",identifier:e[1],export:e[2]})),Rn=c(p(x("func"),f(v(Nt)),f(v(ve))),e=>({parameters:e[1]||[],results:e[2]!==null?[e[2]]:[]})),Zn=c(p(x("type"),f(N),v(Rn)),e=>({nodeType:"type",identifier:e[1],...e[2]})),Un=c(p(x("elem"),v($t),g(N)),e=>({nodeType:"elem",offset:e[1],funcIds:e[2]})),Dn=e=>e.nodeType==="export",Wn=e=>e.nodeType==="func",Gn=e=>e.nodeType==="global",Jn=e=>e.nodeType==="memory",Kn=e=>e.nodeType==="table",Qn=e=>e.nodeType==="type",Xn=e=>e.nodeType==="elem",Et=c(p(x("module"),g(E(v(Fn),v(zn),v(Ln),v(jn),v(Hn),v(Zn),v(Un)))),e=>({nodeType:"module",functions:e[1].filter(Wn),exports:e[1].filter(Dn),globals:e[1].filter(Gn),memories:e[1].filter(Jn),tables:e[1].filter(Kn),types:e[1].filter(Qn),elems:e[1].filter(Xn)})),Yn=c(p(x("assert_return"),v(p(x("invoke"),fe,f(g(v(pe))))),f(v(pe))),e=>({nodeType:"assert_return",invoke:e[1][1],args:j(e[1][2]||[]),expected:e[2]||[]}));g(E(v(Et),v(Yn)));const St=(e,t)=>Se(0,t-e.length).map(n=>"0").join("")+e,qt=(e,t)=>{const s=St(e,t).indexOf("1");return s<0?t:s},Ot=(e,t)=>{const s=St(e,t).lastIndexOf("1");return s<0?t:t-(s+1)},Mt=e=>e.split("").filter(t=>t==="1").length,U=e=>e>>>0,es=e=>e>>0;class l{constructor(t){this.toString=n=>this.value.toString(n),this.toNumber=()=>this.value,this.toObject=()=>({i32:this.value}),this.value=es(t)}}l.obj=e=>new l(e.i32);l.hex=e=>new l(parseInt(e,16));l.bool=e=>e?l.one:l.zero;l.bytes=e=>{const t=new DataView(e);return new l(t.getInt32(0))};l.one=new l(1);l.zero=new l(0);l.not=e=>new l(~e.value);l.neg=e=>new l(-e.value);l.and=(e,t)=>new l(e.value&t.value);l.or=(e,t)=>new l(e.value|t.value);l.xor=(e,t)=>new l(e.value^t.value);l.shiftLeft=(e,t=l.one)=>new l(e.value<<t.value);l.shiftRight_s=(e,t=l.one)=>new l(e.value>>t.value);l.shiftRight_u=(e,t=l.one)=>new l(e.value>>>t.value);l.isZero=e=>e.value===0;l.isNegative=e=>e.value>>31===1;l.isOdd=e=>(e.value&1)===1;l.equal=(e,t)=>(e.value&t.value)===e.value;l.notEqual=(e,t)=>!l.equal(e,t);l.add=(e,t)=>{for(;!l.isZero(t);){const n=l.shiftLeft(l.and(e,t),l.one);e=l.xor(e,t),t=n}return e};l.sub=(e,t)=>l.add(e,l.neg(t));l.mul=(e,t)=>{let n=!1;l.isNegative(e)&&!l.isNegative(t)?(e=l.neg(e),n=!0):l.isNegative(t)&&!l.isNegative(e)?(t=l.neg(t),n=!0):l.isNegative(t)&&l.isNegative(e)&&(e=l.neg(e),t=l.neg(t));let s=l.zero;for(;!l.isZero(t);)l.isOdd(t)&&(s=l.add(s,e)),e=l.shiftLeft(e),t=l.shiftRight_u(t);return n?l.neg(s):s};l.div_s=(e,t)=>new l(e.value/t.value);l.div_u=(e,t)=>new l(U(e.value)/U(t.value));l.rem_s=(e,t)=>new l(e.value%t.value);l.rem_u=(e,t)=>new l(U(e.value)%U(t.value));l.greaterThan_s=(e,t)=>e.value>t.value;l.greaterThan_u=(e,t)=>U(e.value)>U(t.value);l.greaterThanOrEqual_s=(e,t)=>e.value>=t.value;l.greaterThanOrEqual_u=(e,t)=>U(e.value)>=U(t.value);l.lessThan_s=(e,t)=>e.value<t.value;l.lessThan_u=(e,t)=>U(e.value)<U(t.value);l.lessThanOrEqual_s=(e,t)=>e.value<=t.value;l.lessThanOrEqual_u=(e,t)=>U(e.value)<=U(t.value);l.ctz=e=>new l(Ot(e.value.toString(2),32));l.clz=e=>new l(qt(e.value.toString(2),32));l.popcnt=e=>new l(Mt(e.value.toString(2)));class d{constructor(t){this.toString=n=>this.value.toString(n),this.toNumber=()=>this.value,this.toObject=()=>({f32:this.value}),this.value=t}}d.obj=e=>new d(e.f32);d.add=(e,t)=>new d(e.value+t.value);d.sub=(e,t)=>new d(e.value-t.value);d.mul=(e,t)=>new d(e.value*t.value);d.div=(e,t)=>new d(e.value/t.value);d.rem=(e,t)=>new d(e.value%t.value);d.equal=(e,t)=>e.value===t.value;d.notEqual=(e,t)=>e.value!==t.value;d.lessThan=(e,t)=>e.value<t.value;d.lessThanOrEqual=(e,t)=>e.value<=t.value;d.greaterThan=(e,t)=>e.value>t.value;d.greaterThanOrEqual=(e,t)=>e.value>=t.value;d.min=(e,t)=>new d(Math.min(e.value,t.value));d.max=(e,t)=>new d(Math.max(e.value,t.value));d.abs=e=>new d(Math.abs(e.value));d.neg=e=>new d(-e.value);d.ceil=e=>new d(Math.ceil(e.value));d.floor=e=>new d(Math.floor(e.value));d.sqrt=e=>new d(Math.sqrt(e.value));d.trunc=e=>new d(Math.trunc(e.value));d.nearest=e=>new d(2*Math.round(e.value/2));const H=e=>BigInt.asUintN(64,e),ts=e=>BigInt.asIntN(64,e);class u{constructor(t){this.toString=n=>this.value.toString(n),this.toNumber=()=>Number(this.value),this.toObject=()=>({i64:this.value}),this.value=ts(t)}}u.obj=e=>new u(e.i64);u.hex=e=>new u(BigInt(e));u.bool=e=>e?u.one:u.zero;u.one=new u(BigInt(1));u.zero=new u(BigInt(0));u.not=e=>new u(~e.value);u.neg=e=>new u(-e.value);u.and=(e,t)=>new u(e.value&t.value);u.or=(e,t)=>new u(e.value|t.value);u.xor=(e,t)=>new u(e.value^t.value);u.shiftLeft=(e,t=u.one)=>new u(e.value<<t.value);u.shiftRight_s=(e,t=u.one)=>new u(e.value>>t.value);u.shiftRight_u=(e,t=u.one)=>new u(H(e.value)>>H(t.value));u.isZero=e=>e.value===u.zero.value;u.isNegative=e=>e.value<u.zero.value;u.isOdd=e=>(e.value&u.one.value)===u.one.value;u.equal=(e,t)=>(e.value&t.value)===e.value;u.notEqual=(e,t)=>!u.equal(e,t);u.add=(e,t)=>new u(e.value+t.value);u.sub=(e,t)=>new u(e.value-t.value);u.mul=(e,t)=>new u(e.value*t.value);u.div_s=(e,t)=>new u(e.value/t.value);u.div_u=(e,t)=>new u(H(e.value)/H(t.value));u.rem_s=(e,t)=>new u(e.value%t.value);u.rem_u=(e,t)=>new u(H(e.value)%H(t.value));u.greaterThan_s=(e,t)=>e.value>t.value;u.greaterThan_u=(e,t)=>H(e.value)>H(t.value);u.greaterThanOrEqual_s=(e,t)=>e.value>=t.value;u.greaterThanOrEqual_u=(e,t)=>H(e.value)>=H(t.value);u.lessThan_s=(e,t)=>e.value<t.value;u.lessThan_u=(e,t)=>H(e.value)<H(t.value);u.lessThanOrEqual_s=(e,t)=>e.value<=t.value;u.lessThanOrEqual_u=(e,t)=>H(e.value)<=H(t.value);u.ctz=e=>new u(BigInt(Ot(e.value.toString(2),64)));u.clz=e=>new u(BigInt(qt(e.value.toString(2),64)));u.popcnt=e=>new u(BigInt(Mt(e.value.toString(2))));class h{constructor(t){this.toString=n=>this.value.toString(n),this.toNumber=()=>this.value,this.toObject=()=>({f64:this.value}),this.toBytes=()=>{const n=new DataView(new ArrayBuffer(8));return n.setFloat64(0,this.value),new Uint8Array(n.buffer)},this.value=t}}h.obj=e=>new h(e.f64);h.add=(e,t)=>new h(e.value+t.value);h.sub=(e,t)=>new h(e.value-t.value);h.mul=(e,t)=>new h(e.value*t.value);h.div=(e,t)=>new h(e.value/t.value);h.rem=(e,t)=>new h(e.value%t.value);h.equal=(e,t)=>e.value===t.value;h.notEqual=(e,t)=>e.value!==t.value;h.lessThan=(e,t)=>e.value<t.value;h.lessThanOrEqual=(e,t)=>e.value<=t.value;h.greaterThan=(e,t)=>e.value>t.value;h.greaterThanOrEqual=(e,t)=>e.value>=t.value;h.min=(e,t)=>new h(Math.min(e.value,t.value));h.max=(e,t)=>new h(Math.max(e.value,t.value));h.abs=e=>new h(Math.abs(e.value));h.neg=e=>new h(-e.value);h.ceil=e=>new h(Math.ceil(e.value));h.floor=e=>new h(Math.floor(e.value));h.sqrt=e=>new h(Math.sqrt(e.value));h.trunc=e=>new h(Math.trunc(e.value));h.nearest=e=>new h(2*Math.round(e.value/2));const M=e=>t=>{const{values:n}=t,s=n.pop();n.push(e(s))},b=e=>t=>{const{values:n}=t,s=n.pop(),r=n.pop();n.push(e(r,s))},$=e=>b((t,n)=>l.bool(e(t,n))),kt=e=>M(t=>l.bool(e(t))),ns=e=>{switch(e.opType){case"f32.const":return({values:t})=>t.push(d.obj(e.parameter));case"f32.add":return b(d.add);case"f32.sub":return b(d.sub);case"f32.mul":return b(d.mul);case"f32.div":return b(d.div);case"f32.eq":return $(d.equal);case"f32.ne":return $(d.notEqual);case"f32.lt":return $(d.lessThan);case"f32.le":return $(d.lessThanOrEqual);case"f32.gt":return $(d.greaterThan);case"f32.ge":return $(d.greaterThanOrEqual);case"f32.abs":return M(d.abs);case"f32.neg":return M(d.neg);case"f32.copysign":throw new Error(`not implemented ${e.opType}`);case"f32.ceil":return M(d.ceil);case"f32.floor":return M(d.floor);case"f32.trunc":return M(d.trunc);case"f32.nearest":return M(d.nearest);case"f32.sqrt":return M(d.sqrt);case"f32.min":return b(d.min);case"f32.max":return b(d.max);case"f32.demote/f64":case"f32.convert_i32_s":case"f32.convert_i64_s":case"f32.convert_i32_u":case"f32.convert_i64_u":case"f32.reinterpret/i32":throw new Error(`not implemented ${e.opType}`)}return null},ss=e=>{switch(e.opType){case"f64.const":return({values:t})=>t.push(h.obj(e.parameter));case"f64.add":return b(h.add);case"f64.sub":return b(h.sub);case"f64.mul":return b(h.mul);case"f64.div":return b(h.div);case"f64.eq":return $(h.equal);case"f64.ne":return $(h.notEqual);case"f64.lt":return $(h.lessThan);case"f64.le":return $(h.lessThanOrEqual);case"f64.gt":return $(h.greaterThan);case"f64.ge":return $(h.greaterThanOrEqual);case"f64.abs":return M(h.abs);case"f64.neg":return M(h.neg);case"f64.copysign":throw new Error(`not implemented ${e.opType}`);case"f64.ceil":return M(h.ceil);case"f64.floor":return M(h.floor);case"f64.trunc":return M(h.trunc);case"f64.nearest":return M(h.nearest);case"f64.sqrt":return M(h.sqrt);case"f64.min":return b(h.min);case"f64.max":return b(h.max);case"f64.promote/f32":case"f64.convert_i32_s":case"f64.convert_i64_s":case"f64.convert_i32_u":case"f64.convert_i64_u":case"f64.reinterpret/i64":throw new Error(`not implemented ${e.opType}`)}return null},rs=e=>{switch(e.opType){case"i32.const":return({values:t})=>t.push(l.obj(e.parameter));case"i32.add":return b(l.add);case"i32.sub":return b(l.sub);case"i32.mul":return b(l.mul);case"i32.and":return b(l.and);case"i32.or":return b(l.or);case"i32.xor":return b(l.xor);case"i32.eq":return $(l.equal);case"i32.ne":return $(l.notEqual);case"i32.rem_s":return b(l.rem_s);case"i32.rem_u":return b(l.rem_u);case"i32.div_s":return b(l.div_s);case"i32.div_u":return b(l.div_u);case"i32.shl":return b(l.shiftLeft);case"i32.shr_u":return b(l.shiftRight_u);case"i32.shr_s":return b(l.shiftRight_s);case"i32.rotl":case"i32.rotr":throw new Error(`not implemented ${e.opType}`);case"i32.lt_s":return $(l.lessThan_s);case"i32.lt_u":return $(l.lessThan_u);case"i32.le_s":return $(l.lessThanOrEqual_s);case"i32.le_u":return $(l.lessThanOrEqual_u);case"i32.gt_s":return $(l.greaterThan_s);case"i32.gt_u":return $(l.greaterThan_u);case"i32.ge_s":return $(l.greaterThanOrEqual_s);case"i32.ge_u":return $(l.greaterThanOrEqual_u);case"i32.clz":return M(l.clz);case"i32.ctz":return M(l.ctz);case"i32.popcnt":return M(l.popcnt);case"i32.eqz":return kt(l.isZero);case"i32.wrap/i64":case"i32.trunc_f32_s":case"i32.trunc_f64_s":case"i32.trunc_f32_u":case"i32.trunc_f64_u":case"i32.reinterpret/f32":throw new Error(`not implemented ${e.opType}`)}return null},os=e=>{switch(e.opType){case"i64.const":return({values:t})=>t.push(u.obj(e.parameter));case"i64.add":return b(u.add);case"i64.sub":return b(u.sub);case"i64.mul":return b(u.mul);case"i64.and":return b(u.and);case"i64.or":return b(u.or);case"i64.xor":return b(u.xor);case"i64.eq":return $(u.equal);case"i64.ne":return $(u.notEqual);case"i64.rem_s":return b(u.rem_s);case"i64.rem_u":return b(u.rem_u);case"i64.div_s":return b(u.div_s);case"i64.div_u":return b(u.div_u);case"i64.shl":return b(u.shiftLeft);case"i64.shr_u":return b(u.shiftRight_u);case"i64.shr_s":return b(u.shiftRight_s);case"i64.rotl":case"i64.rotr":throw new Error(`not implemented ${e.opType}`);case"i64.lt_s":return $(u.lessThan_s);case"i64.lt_u":return $(u.lessThan_u);case"i64.le_s":return $(u.lessThanOrEqual_s);case"i64.le_u":return $(u.lessThanOrEqual_u);case"i64.gt_s":return $(u.greaterThan_s);case"i64.gt_u":return $(u.greaterThan_u);case"i64.ge_s":return $(u.greaterThanOrEqual_s);case"i64.ge_u":return $(u.greaterThanOrEqual_u);case"i64.clz":return M(u.clz);case"i64.ctz":return M(u.ctz);case"i64.popcnt":return M(u.popcnt);case"i64.eqz":return kt(u.isZero);case"i64.extend_i32_s":case"i64.extend_i32_u":case"i64.trunc_f32_s":case"i64.trunc_f64_s":case"i64.trunc_f32_u":case"i64.trunc_f64_u":case"i64.reinterpret/f64":throw new Error(`not implemented ${e.opType}`)}return null},Me=e=>{const t=new DataView(new ArrayBuffer(8));return t.setBigInt64(0,e,!0),t},as=e=>{switch(e.opType){case"i32.load":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new l(t.getInt32(s,!0)))};case"i64.load":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new u(t.getBigInt64(s,!0)))};case"f32.load":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new d(t.getFloat32(s,!0)))};case"f64.load":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new h(t.getFloat64(s,!0)))};case"i32.load8_s":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new l(t.getInt8(s)))};case"i32.load8_u":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new l(t.getUint8(s)))};case"i32.load16_s":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new l(t.getInt16(s,!0)))};case"i32.load16_u":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new l(t.getUint16(s,!0)))};case"i64.load8_s":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new u(BigInt(t.getInt8(s))))};case"i64.load8_u":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new u(BigInt(t.getUint8(s))))};case"i64.load16_s":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new u(BigInt(t.getInt16(s,!0))))};case"i64.load16_u":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new u(BigInt(t.getUint16(s,!0))))};case"i64.load32_s":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new u(BigInt(t.getInt32(s,!0))))};case"i64.load32_u":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new u(BigInt(t.getUint32(s,!0))))};case"f32.load8_s":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new d(t.getInt8(s)))};case"f32.load8_u":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new d(t.getUint8(s)))};case"f32.load16_s":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new d(t.getInt16(s,!0)))};case"f32.load16_u":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new d(t.getUint16(s,!0)))};case"f64.load8_s":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new h(t.getInt8(s)))};case"f64.load8_u":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new h(t.getUint8(s)))};case"f64.load16_s":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new h(t.getInt16(s,!0)))};case"f64.load16_u":return({memory:t,values:n})=>{const s=n.pop().toNumber()+(e.offset||0);n.push(new h(t.getUint16(s,!0)))};case"i32.store":return({memory:t,values:n})=>{const s=n.pop(),r=n.pop().toNumber()+(e.offset||0);t.setInt32(r,s.toNumber(),!0)};case"i64.store":return({memory:t,values:n})=>{const s=n.pop(),r=n.pop().toNumber()+(e.offset||0);t.setBigInt64(r,s.value,!0)};case"f32.store":return({memory:t,values:n})=>{const s=n.pop(),r=n.pop().toNumber()+(e.offset||0);t.setFloat32(r,s.toNumber(),!0)};case"f64.store":return({memory:t,values:n})=>{const s=n.pop(),r=n.pop().toNumber()+(e.offset||0);t.setFloat64(r,s.toNumber(),!0)};case"i32.store8":return({memory:t,values:n})=>{const s=n.pop(),r=n.pop().toNumber()+(e.offset||0);t.setInt8(r,s.toNumber())};case"i32.store16":return({memory:t,values:n})=>{const s=n.pop(),r=n.pop().toNumber()+(e.offset||0);t.setInt16(r,s.toNumber(),!0)};case"i64.store8":return({memory:t,values:n})=>{const s=n.pop(),r=n.pop().toNumber()+(e.offset||0);t.setInt8(r,Me(s.value).getInt8(0))};case"i64.store16":return({memory:t,values:n})=>{const s=n.pop(),r=n.pop().toNumber()+(e.offset||0);t.setInt16(r,Me(s.value).getInt16(0,!0),!0)};case"i64.store32":return({memory:t,values:n})=>{const s=n.pop(),r=n.pop().toNumber()+(e.offset||0);t.setInt32(r,Me(s.value).getInt32(0,!0),!0)}}return null},ls=e=>{switch(e.opType){case"drop":return({values:t})=>{t.pop()};case"get_local":case"local.get":return({values:t,local:n})=>{const s=e.parameter;t.push(n[s])};case"set_local":case"local.set":return({values:t,local:n})=>{const s=e.parameter;n[s]=t.pop()};case"tee_local":case"local.tee":return({values:t,local:n})=>{const s=e.parameter;n[s]=t.peek()};case"get_global":case"global.get":return({values:t,global:n})=>{const s=e.parameter;t.push(n[s])};case"set_global":case"global.set":return({values:t,global:n})=>{const s=e.parameter;n[s]=t.pop()}}return null},qe=e=>{if("i32"in e)return l.obj(e);if("i64"in e)return u.obj(e);if("f32"in e)return d.obj(e);if("f64"in e)return h.obj(e);throw new Error("not supported number type")},is=(e,t)=>{switch(e){case L.i32:return new l(t).toObject();case L.i64:return new u(BigInt(t)).toObject();case L.f32:return new d(t).toObject();case L.f64:return new h(t).toObject()}};class At{constructor(){this.arr=[],this.push=t=>{this.arr.push(t)},this.pop=()=>{if(this.arr.length===0)throw new Error("Stack is empty");return this.arr.pop()},this.peek=()=>{if(this.arr.length===0)throw new Error("Stack is empty");return this.arr[this.arr.length-1]}}}const us=(e,t=!1)=>(n,s)=>{const r=(...i)=>{t&&console.log(...i)};for(;s.programCounter<n.length&&!s.programTerminated;){const i=n[s.programCounter++],m=e(i);r("[%d] run %o",s.programCounter,i);try{m(s)}catch(_){console.error(`Exception thrown at ${s.programCounter}: ${_.message} ${JSON.stringify(i)}`);break}}},st=(e,t)=>{const{functions:n}=e,s=n[t];Ct(s)(e)},we=(e,t,n,s,r)=>{Bt(t,n,s)(e,r)},cs=e=>t=>{switch(t.opType){case"nop":return()=>{};case"unreachable":throw new Error(`not implemented ${t.opType}`);case"block":return n=>{we(n,t.body,t.results,ne.tail,e)};case"loop":return n=>{we(n,t.body,t.results,ne.head,e)};case"if":return n=>{l.isZero(n.values.pop())?we(n,t.else,t.results,ne.tail,e):we(n,t.then,t.results,ne.tail,e)};case"br":return()=>{e.break(t.parameter)};case"br_if":return n=>{const{values:s}=n;l.isZero(s.pop())||e.break(t.parameter)};case"br_table":return n=>{const s=t.parameters,{values:r}=n,i=r.pop().value,m=i<s.length&&i>=0?s[i]:s[s.length-1];e.break(m)};case"return":return n=>e.return(n);case"call":return n=>{const s=t.parameter;st(n,s)};case"call_indirect":return n=>{const s=n.values.pop(),r=n.table[s.value];st(n,r)};case"select":return n=>{const{values:s}=n,r=s.pop();let i;if(r instanceof l)i=l.isZero(r);else if(r instanceof u)i=u.isZero(r);else throw new Error(`unsupported type: ${typeof r}`);const m=s.pop(),_=s.pop();s.push(i?m:_)}}return null};var ne;(function(e){e[e.tail=0]="tail",e[e.head=1]="head"})(ne||(ne={}));const Ct=e=>{const t=Bt(e.body,e.results,ne.tail);return n=>{const s={...n,local:[...Se(0,e.parameters.length).map(i=>n.values.pop()),...e.locals.map(i=>is(i,0)).map(i=>qe(i))]};t(s,{return:i=>{e.results.map(m=>i.values.pop()).forEach(n.values.push)},break:()=>{throw new Error("invalid break")}})}},Bt=(e,t,n)=>(s,r)=>{const i={...s,values:new At,programCounter:0};ds(cs({break:A=>{i.programCounter=(()=>{switch(n){case ne.tail:return e.length;case ne.head:return 0}})(),A>0&&r.break(A-1)},return:A=>{r.return(A),i.programTerminated=!0}}))(e,i),!i.programTerminated&&t.map(A=>i.values.pop()).forEach(s.values.push)},ps=e=>t=>{for(const n of e){const s=n(t);if(s!==null)return s}throw new Error(`There is no instruction for ${JSON.stringify(t)}`)},fs=[as,ls,rs,os,ns,ss],ds=e=>us(ps([...fs,e])),hs=e=>{const t={};return e.forEach(n=>{n.funcIds.forEach((s,r)=>{const i=n.offset,m=qe(i.parameter).value;t[m+r]=s})}),t},ms=e=>e.map(t=>{const n=t.init;return qe(n.parameter)});class _s{constructor(t){this.functions=t.functions,this.table=hs(t.elems),this.global=ms(t.globals)}callFunction(t,...n){const{functions:s}=this,r=s.findIndex(_=>_.export===t),i=s[r],m={functions:s,table:this.table,values:new At,memory:new DataView(new ArrayBuffer(1024)),local:[],global:this.global,programCounter:0,programTerminated:!1};return n.map(qe).reverse().forEach(m.values.push),Ct(i)(m),i.results.map(_=>m.values.pop().toObject())}}const $e=e=>{const t={};for(const[n,s]of e)t[n]=s;return t},gs=e=>typeof e=="string",xs=(e,t)=>{for(let n=e.length-1;n>=0;n--)if(t(e[n]))return e.length-n-1;return-1},bs=e=>gs(e)&&e.startsWith("$"),Vt=e=>{switch(e.opType){case"text.get_global":case"text.global.get":throw new Error("not implemented")}return e},Ie=(e,t,n)=>{const s=_=>xs(n,y=>y===_),r=_=>t.globals[_],i=_=>t.locals[_],m=_=>t.funcs[_];switch(e.opType){case"text.if":return vs(e,t,n);case"text.block":return rt("block",e,t,n);case"text.loop":return rt("loop",e,t,n);case"text.call":return{opType:"call",parameter:m(e.parameter)};case"text.br":return{opType:"br",parameter:s(e.parameter)};case"text.br_if":return{opType:"br_if",parameter:s(e.parameter)};case"text.br_table":return{opType:"br_table",parameters:e.parameters.map(s)};case"text.local.get":return{opType:"local.get",parameter:i(e.parameter)};case"text.local.set":return{opType:"local.set",parameter:i(e.parameter)};case"text.local.tee":return{opType:"local.tee",parameter:i(e.parameter)};case"text.get_local":return{opType:"get_local",parameter:i(e.parameter)};case"text.set_local":return{opType:"set_local",parameter:i(e.parameter)};case"text.tee_local":return{opType:"tee_local",parameter:i(e.parameter)};case"text.global.get":return{opType:"global.get",parameter:r(e.parameter)};case"text.global.set":return{opType:"global.set",parameter:r(e.parameter)};case"text.get_global":return{opType:"get_global",parameter:r(e.parameter)};case"text.set_global":return{opType:"set_global",parameter:r(e.parameter)}}return e},rt=(e,t,n,s)=>{const r=[...s,t.identifier],i=t.body.map(m=>Ie(m,n,r));return{opType:e,body:i,results:t.results}},vs=(e,t,n)=>{const s=[...n,e.identifier];return{opType:"if",results:e.results,then:e.then.map(r=>Ie(r,t,s)),else:e.else.map(r=>Ie(r,t,s))}},ws=e=>{const t=$e(e.parameters.map((s,r)=>[s.identifier,r]).filter(s=>s[0])),n=$e(e.locals.map((s,r)=>[s.identifier,e.parameters.length+r]).filter(s=>s[0]));return{...t,...n}},ys=(e,t,n)=>{const s={locals:ws(e),globals:n,funcs:t};return{body:e.body.map(r=>Ie(r,s,[])),parameters:e.parameters.map(r=>r.type),locals:e.locals.map(r=>r.type),export:e.export,results:e.results}},Ts=(e,t)=>{const n=e.funcIds.map(s=>bs(s)?t[s]:s);return{offset:Vt(e.offset),funcIds:n}},$s=e=>{const t=$e(e.functions.map((s,r)=>[s.identifier,r]).filter(s=>s[0])),n=$e(e.globals.map((s,r)=>[s.identifier,r]).filter(s=>s[0]));return{elems:e.elems.map(s=>Ts(s,t)),functions:e.functions.map(s=>ys(s,t,n)),globals:e.globals.map(s=>({...s,init:Vt(s.init)}))}},Is=e=>{const t=e.funcs.map((r,i)=>{const m=e.codes[i],_=e.types[r],y=e.exports.find(k=>"func"in k.desc&&k.desc.func===i);return{export:y?y.name:null,parameters:_.parameters,results:_.results,body:m.body,locals:m.locals}}),n=e.elems.map(r=>({offset:r.offset,funcIds:r.init})),s=e.globals.map(r=>({type:r.type.type,mutable:r.type.isMutable,init:r.init}));return{functions:t,elems:n,globals:s}},Ns=e=>(t,n)=>t[n]===e.charCodeAt(0)?[!0,t[n],n+1]:[!1,null,n],Es=e=>p(...e.split("").map(Ns)),T=e=>(t,n)=>t[n]===e?[!0,t[n],n+1]:[!1,null,n],Ss=e=>p(...e.map(T)),Oe=e=>(t,n)=>t.length<n+e?[!1,t,n,`target is smaller than ${n+e}`]:[!0,t.slice(n,n+e),n+e],X=fn,V=e=>Ee(X,t=>dn(e,t)),Pt=(e,t)=>Se(0,t-e.length).map(n=>"0").join("")+e,qs=e=>Pt(e,Math.ceil(e.length/8)*8).match(/.{8}/g).map(t=>parseInt(t,2).toString(16)).join(""),je=Ee(X,e=>{const t=e>>7===1,n=e&127;return t?c(je,s=>[n,...s]):hn([n])}),Y=c(je,e=>{let t=0;return e.forEach((n,s)=>{t+=n<<7*s}),t}),zt=c(je,e=>{const t=e.map(n=>Pt(n.toString(2),7)).join("");return"0x"+qs(t)}),Os=c(zt,e=>({i32:parseInt(e)})),Ms=c(zt,e=>({i64:BigInt(e)})),ks=c(Oe(4),e=>({f32:new DataView(new Uint8Array(e).buffer).getFloat32(0,!0)})),As=c(Oe(8),e=>({f64:new DataView(new Uint8Array(e).buffer).getFloat64(0,!0)})),xe=E(c(T(127),e=>L.i32),c(T(126),e=>L.i64),c(T(125),e=>L.f32),c(T(124),e=>L.f64)),Pe=Ee(X,e=>c(Oe(e),t=>t.map(n=>String.fromCharCode(n)).join(""))),Ft=Y,Lt=Y,jt=Y,Ht=Y,Cs=Y,Rt=E(c(p(T(0),X),e=>({min:e[1]})),c(p(T(1),X,X),e=>({min:e[1],max:e[2]}))),a=(e,t)=>c(T(e),n=>({opType:t})),q=(e,t,n)=>c(p(T(e),n),s=>({opType:t,...s[1]})),Z=(e,t,n=X)=>c(p(T(e),n),s=>({opType:t,parameter:s[1]})),Zt=Z(35,"global.get"),Ut=E(Z(65,"i32.const",Os),Z(66,"i64.const",Ms),Z(67,"f32.const",ks),Z(68,"f64.const",As)),He=c(p(E(Ut,Zt),T(11)),e=>e[0]),Dt=ie(()=>E(a(0,"unreachable"),a(1,"nop"),c(p(T(2),ke,ye),e=>({opType:"block",results:e[1],body:e[2]})),c(p(T(3),ke,ye),e=>({opType:"loop",results:e[1],body:e[2]})),c(p(T(4),ke,f(Bs),ye),e=>({opType:"if",results:e[1],then:e[2],else:e[2]})),Z(12,"br"),Z(13,"br_if"),c(p(T(14),V(X)),e=>({opType:"br_table",parameters:e[1]})),a(15,"return"),Z(16,"call"),c(p(T(17),X,T(0)),e=>({opType:"call_indirect",typeIndex:e[1]})),a(26,"drop"),a(27,"select"),Z(32,"local.get"),Z(33,"local.set"),Z(34,"local.tee"),Zt,Z(36,"global.set"),Ut,q(40,"i32.load",O),q(41,"i64.load",O),q(42,"f32.load",O),q(43,"f64.load",O),q(44,"i32.load8_s",O),q(45,"i32.load8_u",O),q(46,"i32.load16_s",O),q(47,"i32.load16_u",O),q(48,"i64.load8_s",O),q(49,"i64.load8_u",O),q(50,"i64.load16_s",O),q(51,"i64.load16_u",O),q(52,"i64.load32_s",O),q(53,"i64.load32_u",O),q(54,"i32.store",O),q(55,"i64.store",O),q(56,"f32.store",O),q(57,"f64.store",O),q(58,"i32.store8",O),q(59,"i32.store16",O),q(60,"i64.store8",O),q(61,"i64.store16",O),q(62,"i64.store32",O),c(p(T(63),T(0)),e=>({opType:"memory.size"})),c(p(T(64),T(0)),e=>({opType:"memory.grow"})),a(69,"i32.eqz"),a(70,"i32.eq"),a(71,"i32.ne"),a(72,"i32.lt_s"),a(73,"i32.lt_u"),a(74,"i32.gt_s"),a(75,"i32.gt_u"),a(76,"i32.le_s"),a(77,"i32.le_u"),a(78,"i32.ge_s"),a(79,"i32.ge_u"),a(80,"i64.eqz"),a(81,"i64.eq"),a(82,"i64.ne"),a(83,"i64.lt_s"),a(84,"i64.lt_u"),a(85,"i64.gt_s"),a(86,"i64.gt_u"),a(87,"i64.le_s"),a(88,"i64.le_u"),a(89,"i64.ge_s"),a(90,"i64.ge_u"),a(91,"f32.eq"),a(92,"f32.ne"),a(93,"f32.lt"),a(94,"f32.gt"),a(95,"f32.le"),a(96,"f32.ge"),a(97,"f64.eq"),a(98,"f64.ne"),a(99,"f64.lt"),a(100,"f64.gt"),a(101,"f64.le"),a(102,"f64.ge"),a(103,"i32.clz"),a(104,"i32.ctz"),a(105,"i32.popcnt"),a(106,"i32.add"),a(107,"i32.sub"),a(108,"i32.mul"),a(109,"i32.div_s"),a(110,"i32.div_u"),a(111,"i32.rem_s"),a(112,"i32.rem_u"),a(113,"i32.and"),a(114,"i32.or"),a(115,"i32.xor"),a(116,"i32.shl"),a(117,"i32.shr_s"),a(118,"i32.shr_u"),a(119,"i32.rotl"),a(120,"i32.rotr"),a(121,"i64.clz"),a(122,"i64.ctz"),a(123,"i64.popcnt"),a(124,"i64.add"),a(125,"i64.sub"),a(126,"i64.mul"),a(127,"i64.div_s"),a(128,"i64.div_u"),a(129,"i64.rem_s"),a(130,"i64.rem_u"),a(131,"i64.and"),a(132,"i64.or"),a(133,"i64.xor"),a(134,"i64.shl"),a(135,"i64.shr_s"),a(136,"i64.shr_u"),a(137,"i64.rot_l"),a(138,"i64.rotr"),a(139,"f32.abs"),a(140,"f32.neg"),a(141,"f32.ceil"),a(142,"f32.floor"),a(143,"f32.trunc"),a(144,"f32.nearest"),a(145,"f32.sqrt"),a(146,"f32.add"),a(147,"f32.sub"),a(148,"f32.mul"),a(149,"f32.div"),a(150,"f32.min"),a(151,"f32.max"),a(152,"f32.copysign"),a(153,"f64.abs"),a(154,"f64.neg"),a(155,"f64.ceil"),a(156,"f64.floor"),a(157,"f64.trunc"),a(158,"f64.nearest"),a(159,"f64.sqrt"),a(160,"f64.add"),a(161,"f64.sub"),a(162,"f64.mul"),a(163,"f64.div"),a(164,"f64.fmin"),a(165,"f64.fmax"),a(166,"f64.copysign"),a(167,"i32.wrap_i64"),a(168,"i32.trunc_f32_s"),a(169,"i32.trunc_f32_u"),a(170,"i32.trunc_f64_s"),a(171,"i32.trunc_f64_u"),a(172,"i64.extend_i32_s"),a(173,"i64.extend_i32_u"),a(174,"i64.trunc_f32_s"),a(175,"i64.trunc_f32_u"),a(176,"i64.trunc_f64_s"),a(177,"i64.trunc_f64_u"),a(178,"f32.convert_i32_s"),a(179,"f32.convert_i32_u"),a(180,"f32.convert_i64_s"),a(181,"f32.convert_i64_u"),a(182,"f32.demote_f64"),a(183,"f64.convert_i32_s"),a(184,"f64.convert_i32_u"),a(185,"f64.convert_i64_s"),a(186,"f64.convert_i64_u"),a(187,"f64.promote_f32"),a(188,"i32.reinterpret_f32"),a(189,"i64.reinterpret_f64"),a(190,"f32.reinterpret_i32"),a(191,"f64.reinterpret_i64"))),O=c(p(Y,Y),e=>({align:e[0],offset:e[1]})),ke=E(c(T(64),e=>[]),c(xe,e=>[e])),Bs=c(p(g(Dt),T(5)),e=>e[0]),ye=c(p(g(Dt),T(11)),e=>e[0]),Vs=e=>c(p(T(e),Y),t=>({id:e,size:t[1]})),D=(e,t,n)=>Ee(Vs(e),s=>c(Oe(s.size),r=>{const i=n(r,0);return{nodeType:t,...s,sections:i?i[1]:[]}})),Ps=c(p(Y,xe),e=>Se(0,e[0]).map(t=>e[1])),zs=c(p(V(Ps),ye),e=>({locals:j(e[0]),body:e[1]})),Fs=c(p(Y,zs),e=>({size:e[0],...e[1]})),Ls=D(10,"code",V(Fs)),J=D(0,"custom",e=>null),js=c(p(Ht,He,V(X)),e=>({data:e[0],offset:e[1],init:e[2]})),Hs=D(11,"data",V(js)),Rs=c(p(jt,He,V(Ft)),e=>({table:e[0],offset:e[1],init:e[2]})),Zs=D(9,"elem",V(Rs)),Wt=E(c(p(T(0),Lt),e=>({func:e[1]})),c(p(T(1),jt),e=>({table:e[1]})),c(p(T(2),Ht),e=>({mem:e[1]})),c(p(T(3),Cs),e=>({global:e[1]}))),Us=c(p(Pe,Pe,Wt),e=>({module:e[0],name:e[1],desc:e[2]})),Ds=D(2,"import",V(Us)),Ws=c(p(Pe,Wt),e=>({name:e[0],desc:e[1]})),Gs=D(7,"export",V(Ws)),Js=D(3,"func",V(Lt)),Ks=E(c(T(0),e=>!1),c(T(1),e=>!0)),Qs=c(p(xe,Ks),e=>({type:e[0],isMutable:e[1]})),Xs=c(p(Qs,He),e=>({type:e[0],init:e[1]})),Ys=D(6,"global",V(Xs)),er=Rt,tr=er,nr=D(5,"mem",V(tr)),sr=c(Ft,e=>({func:e})),rr=D(8,"start",V(sr));var ot;(function(e){e[e.funcref=112]="funcref"})(ot||(ot={}));const or=T(112),ar=c(p(or,Rt),e=>({et:e[0],lim:e[1]})),lr=D(4,"table",V(ar)),ir=c(p(T(96),V(xe),V(xe)),e=>({parameters:e[1],results:e[2]})),ur=D(1,"type",V(ir)),cr=c(p(Es("\0asm"),X,Ss([0,0,0])),e=>({version:e[1]})),K=e=>e==null?[]:j(e.map(t=>t.sections)),pr=c(p(cr,f(g(ur)),f(g(J)),f(g(Ds)),f(g(J)),f(g(Js)),f(g(J)),f(g(lr)),f(g(J)),f(g(nr)),f(g(J)),f(g(Ys)),f(g(J)),f(g(Gs)),f(g(J)),f(g(rr)),f(g(J)),f(g(Zs)),f(g(J)),f(g(Ls)),f(g(J)),f(g(Hs)),f(g(J))),e=>({version:e[0].version,types:K(e[1]),imports:K(e[3]),funcs:K(e[5]),tables:K(e[7]),mems:K(e[9]),globals:K(e[11]),exports:K(e[13]),starts:K(e[15]),elems:K(e[17]),codes:K(e[19]),data:K(e[21])}));function fr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Te={exports:{}},dr=Te.exports,at;function hr(){return at||(at=1,function(e,t){(function(n,s){e.exports=s()})(dr,function(){var n={keyColor:"dimgray",numberColor:"lightskyblue",stringColor:"lightcoral",trueColor:"lightseagreen",falseColor:"#f66578",nullColor:"cornflowerblue"},s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#x60;","=":"&#x3D;"};function r(m){return String(m).replace(/[&<>"'`=]/g,function(_){return s[_]})}function i(m,_){_===void 0&&(_={});var y=typeof m;y!=="string"&&(m=JSON.stringify(m,null,2)||y);var k=Object.assign({},n,_);return m=m.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">"),m.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+]?\d+)?)/g,function(A){var w=k.numberColor,P="";return/^"/.test(A)?/:$/.test(A)?w=k.keyColor:(w=k.stringColor,A='"'+r(A.substr(1,A.length-2))+'"',P="word-wrap:break-word;white-space:pre-wrap;"):w=/true/.test(A)?k.trueColor:/false/.test(A)?k.falseColor:/null/.test(A)?k.nullColor:w,'<span style="'+P+"color:"+w+'">'+A+"</span>"})}return i})}(Te)),Te.exports}var mr=hr();const _r=fr(mr),Re=e=>(t,n)=>{e.lastIndex=0;const s=e.exec(t.slice(n));return s?[!0,s[0],n+s[0].length]:[!1,null,n]},ze=e=>Re(new RegExp(e)),gr=Re(/-?[0-9]+\.?[0-9]*/),xr=(e,t)=>c(p(f(g(c(p(e,ze(t)),n=>n[0]))),e),n=>[...n[0]||[],n[1]]),br=c(p(Re(/[a-zA-Z]+/),ze("\\("),f(xr(gr,",")),ze("\\)")),e=>({type:"func-call",name:e[0],arguments:e[2]})),vr=E(br);let ee;const Ae=e=>Fe(pn(_r(e,{keyColor:"#c074fb",stringColor:"#e3c330",nullColor:"#929292",numberColor:"white",trueColor:"white",falseColor:"white"}))),Fe=e=>le` <pre class="Code"><code>${e}</code></pre> `,Ce=e=>le`
  <pre class="Code Error"><code>${e}</code></pre>
`,wr=`(module 
  (func (export "add") (param i32) (param i32) (result i32)
    get_local 0 
    get_local 1
    i32.add
  )
  (func $fib (export "fib") (param $p0 i32) (result i32) (local $l0 i32)
    i32.const 1
    set_local $l0
    block $B0
      get_local $p0
      i32.const 2
      i32.lt_u
      br_if $B0
      i32.const 1
      set_local $l0
      loop $L1
        get_local $p0
        i32.const -1
        i32.add
        call $fib
        get_local $l0
        i32.add
        set_local $l0
        get_local $p0
        i32.const -2
        i32.add
        tee_local $p0
        i32.const 1
        i32.gt_u
        br_if $L1
      end
    end
    get_local $l0
  )
)`,yr=(e,t,n,s)=>e.map((r,i)=>{const m=`${t}-${i}`;return le`
      <input
        type="radio"
        name=${t}
        id=${m}
        .checked=${r.data===n}
        @change=${()=>s(r.data)}
      />
      <label for=${m}>${r.label}</label>
    `}),Tr=()=>{const{sParserInput:e,consoleInput:t,consoleOutput:n,inputMode:s,wasmBinary:r}=ee(),i=mt(e,0),m=i[0]?Et(i[1],0):null,_=r?r.map(S=>S.toString(16)).join(" "):"",y=r?pr(r,0):null,k=(()=>{switch(s){case 0:return m!==null&&m[0]?$s(m[1]):null;case 1:return y!==null&&y[0]?Is(y[1]):null}})(),A=S=>{ee({sParserInput:S.target.value})},w=S=>{ee({consoleInput:S.target.value})},P=S=>{if(S.key==="Enter"){if(k===null)return;const{consoleInput:z,consoleOutput:W}=ee(),G=new _s(k),R=vr(z,0);if(!R[0]){const de=`> ${z}
invalid command: ${R[3]}`;ee({consoleInput:"",consoleOutput:[...W,de]});return}const Ze=R[1],Jt=G.callFunction(Ze.name,...Ze.arguments.map(de=>({i32:parseInt(de)}))).map(de=>JSON.stringify(de)).join(", "),Kt=`> ${z}
${Jt}`;ee({consoleInput:"",consoleOutput:[...W,Kt]})}},ue=S=>{const z=new FileReader;z.onload=()=>{const W=z.result,G=Array.from(new Uint8Array(W));ee({wasmBinary:G})},z.readAsArrayBuffer(S.currentTarget.files[0])};return le`
    <div class="App">
      <h1>Playground</h1>

      <div class="mode">
        ${yr([{label:"Text",data:0},{label:"Binary",data:1}],"input-select",s,S=>ee({inputMode:S}))}
      </div>

      <div class="sections">
        ${s===0?le`
                <section>
                  <h2>Input Text</h2>
                  <textarea
                    @input=${A}
                    .value=${e}
                  ></textarea>
                </section>

                <section>
                  <h2>S-Expression Parser</h2>
                  ${i[0]?Ae(i[1]):Ce(i[3])}
                </section>

                <section>
                  <h2>WebAssembly Text Format Parser</h2>
                  ${m&&(m[0]?Ae(m[1]):Ce(m[3]))}
                </section>
              `:null}

        ${s===1?le`
                <section>
                  <h2>Open .wasm file</h2>
                  <div class="file-input">
                    <input type="file" accept=".wasm" @change=${ue} />
                    ${Fe(_)}
                  </div>
                </section>

                <section>
                  <h2>WebAssembly Binary Format Parser</h2>
                  ${y&&(y[0]?Ae(y[1]):Ce(y[3]))}
                </section>
              `:null}

        <section>
          <h2>Console</h2>
          <div class="console-content">
            <div class="input-wrapper">
              <span class="mark">&#10095;</span>
              <input
                type="text" 
                .value=${t} 
                @input=${w}
                @keypress=${P}
              />
            </div>
            <div class="section functions">
              <p class="title">functions</p>
              <ul>
              ${k!==null?k.functions.filter(S=>S.export).map(S=>le`
                            <li>${S.export}(${S.parameters.join(", ")})</li>
                          `):null}
              </ul>
            </div>
            <div class="section output">
              <p class="title">output</p>
              ${Fe(n.join(`
`))}
            </div>
          </div
        </section>
      </div>
    </div>
  `},Gt=()=>cn(Tr(),document.body),$r=e=>{let t=e;return(n=null)=>(n&&(t={...t,...n},Gt()),t)};ee=$r({inputMode:0,wasmBinary:null,sParserInput:wr,consoleInput:"",consoleOutput:[]});Gt();
